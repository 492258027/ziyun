
JWT的原理:服务器认证以后，生成一个JSON对象，发回给用户。 以后用户与服务端通信的时候，都要带着这个JSON对象。
服务器完全只靠这个对象认定用户身份。为了防止用户篡改数据，服务器在生成这个对象的时候会加上签名。

JWT是一个很长的字符串，中间用点(.)分隔成三个部分
Header（头部）
Payload（负载）
Signature（签名）
写成一行: Header.Payload.Signature

Header 部分是一个 JSON 对象，描述 JWT 的元数据，通常是下面的样子。
{ "alg": "HS256", "typ": "JWT" }
alg属性表示签名的算法(algorithm)，默认是 HMAC SHA256（写成 HS256）;
typ属性表示这个令牌（token）的类型（type），JWT 令牌统一写为JWT。
最后，将上面的 JSON 对象使用 Base64URL 算法转成字符串。

Payload 部分也是一个 JSON 对象，用来存放实际需要传递的数据。
JWT 规定了7个官方字段，供选用。
iss (issuer)：签发人
exp (expiration time)：过期时间
sub (subject)：主题
aud (audience)：受众
nbf (Not Before)：生效时间
iat (Issued At)：签发时间
jti (JWT ID)：编号
除了官方字段，你还可以在这个部分定义私有字段.
注意，JWT 默认是不加密的，任何人都可以读到，所以不要把秘密信息放在这个部分。
这个 JSON 对象也要使用 Base64URL 算法转成字符串。

Signature 部分是对前两部分的签名，防止数据篡改。
需要指定一个密钥（secret）。这个密钥只有服务器才知道，不能泄露给用户。
使用 Header 里面指定的签名算法，按照下面的公式产生签名。
HMACSHA256( base64UrlEncode(header) + "." + base64UrlEncode(payload), secret)
算出签名以后，把 Header、Payload、Signature 三个部分拼成一个字符串，每个部分之间用"点"（.）分隔，就可以返回给用户。

JWT有几个注意点：
JWT 默认是不加密，但也是可以加密的。生成原始 Token 以后，可以用密钥再加密一次。 不加密的情况下，不能将秘密数据写入 JWT。
JWT 不仅可以用于认证，也可以用于交换信息。有效使用 JWT，可以降低服务器查询数据库的次数。
JWT 的最大缺点是，服务器无法在使用过程中废止某个 token，或者更改 token 的权限。也就是说，一旦 JWT 签发了，在到期之前就会始终有效，除非服务器部署额外的逻辑。JWT 的有效期应该设置得比较短。对于一些比较重要的权限，使用时应该再次对用户进行认证。
JWT 不应该使用 HTTP 协议明码传输，要使用 HTTPS 协议传输。


一）base64（不是加密方式，只是编码方式，可以反解）
Base64是网络上最常见的用于传输8Bit字节码的编码方式之一，Base64就是一种基于64个可打印字符来表示二进制数据的方法，
可用于在HTTP环境下传递较长的标识信息，base64是可以反解的，不是加密的方式。
Base64URL为了方便在url中使用， 替换了在URL中有特殊含义的三个字符+、/和=.(=被省略、+替换成-，/替换成_ )

二）散列（md5和sha256）
散列（消息摘要算法）的主要特征是加密过程不需要密钥，并且经过散列的数据无法被反解密
只有输入相同的明文数据经过相同的散列才能得到相同的密文。

JWT是 HMAC SHA-256。HMAC 需要密钥. 它通过一个标准算法，在计算哈希的过程中，把key混入计算过程中。

三）加密算法(对称加密和非对称加密)
加密技术包括两个元素：加密算法和密钥。

对称加密（私人密钥加密DES）： 对称加密的加密密钥和解密密钥相同, 优点是速度快，缺点是密钥管理不方便，要求共享密钥。
非对称加密（公开密钥加密RSA）：
非对称加密算法需要两个密钥：公开密钥（publickey）和私有密钥 （privatekey）。
公开密钥与私有密钥是一对，如果用公钥对数据进行加密，只有用对应的私钥才能解密；如果用私钥对数据进行加密，那么只有用对应的公钥才能解密。
非对称加密算法的优点是密钥管理很方便，缺点是速度慢。

四）数字签名
数字签名所用的技术是散列和非对称加密。数字签名的假设是： 只有你自己有你的私钥。通过散列(md5和sha256)，我们先为你要签名的信息生成一个Hash字串(Hash1)，
然后用你的私钥加密得到Encrypted(Hash1)，这就是你对这个文档的数字签名。当别人需要验证某个文档是否是你签名的时候，只需要用你的公钥解密你的签名得到Hash1，
并和该文档计算出来的Hash2对比，查看是否一致。如果一致则说明你确实对该文档签过名。 私钥签名,公钥验证
